\newcommand{\umldomainclass}[4][]{
	\matrix[
		matrix of nodes,
		nodes={draw, anchor=center, inner sep=2pt, text width=#4, align=center},
		column sep=0pt, row sep=0pt, inner sep=0pt,
		#1
	] (#2) {
		\node[font=\normalsize, align=center] {\textbf{#2}}; \\ % nome
		\node[font=\small, align=left] {#3}; \\   % attributi
	};
}



\begin{figure}[h]
	\centering
	
	\begin{tikzpicture}
		\umlsimpleclass[x = 0, y = 0, fill=white]{Persona}
		\umlsimpleclass[x = 6, y = 0, fill=white]{Utente}
		\umldomainclass[at={(12, 0)}]{Account}{username \\ email \\ password}{2cm}
		\umldomainclass[at={(6,-2)}]{Amministratore}{rank}{3cm}
		
		\umlsimpleclass[x=10, y=-4, fill=white]{Mappa}
		\umldomainclass[at={(0, -4)}]{Percorso}{stimaTempo \\ distanza \\ stimaCO\textsubscript{2}}{2cm}
		\umldomainclass[at={(6, -4)}]{Posizione}{latitudine \\ longitudine}{2cm}
		
		\umldomainclass[at={(0,-7)}]{ModalitàTrasporto}{velocità \\ CO\textsubscript{2}PerChilometro}{4cm}
		\umlsimpleclass[x=-4.5, y=-9, fill=white]{Cammino}
		\umlsimpleclass[x=-1.5, y=-10, fill=white]{Bici}
		\umlsimpleclass[x=1.5, y=-10, fill=white]{TrasportoPubblico}
		\umlsimpleclass[x=4.5, y=-9, fill=white]{Macchina}		

		\umlinherit{Utente}{Persona}
		\umlinherit{Amministratore}{Utente}

		\draw (0,0.35) -- (0,1.35);
		\draw (12,0.75) -- (12,1.35);
		\draw (0,1.35) -- (12,1.36);
		\node at (5, 1.5) {crea→};
		\node at (-0.2, 0.55) {1};
		\node at (12.35, 1) {0..*};

		\node at (9, 0.25) {identificato\_da→};
		\umlassoc[mult1 = 1, mult2 = 1]{Utente}{Account}

		\node at (-0.5, -2) {cerca↓};
		\umlassoc[mult1=0..*, mult2 = 0..*]{Persona}{Percorso}
		
		\node at (3, -3.85) {passa\_per→};
		\umluniaggreg[mult1=0..*, mult2 = 0..*]{Percorso}{Posizione}

		\node at (8, -3.8) {è\_in→};
		\umlassoc[mult1=0..*, mult2 = 1]{Posizione}{Mappa}
		
		\node at (0.4, -5.5) {usa↓};
		\umlassoc[mult1=0..*, mult2 = 0..*]{Percorso}{ModalitàTrasporto}

		\umlinherit{Cammino}{ModalitàTrasporto}
		\umlinherit{Bici}{ModalitàTrasporto}
		\umlinherit{TrasportoPubblico}{ModalitàTrasporto}
		\umlinherit{Macchina}{ModalitàTrasporto}
	\end{tikzpicture}
\end{figure}