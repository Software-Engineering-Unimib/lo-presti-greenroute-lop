\newcommand{\umldomainclass}[4][]{
	\matrix[
		matrix of nodes,
		nodes={draw, anchor=center, inner sep=2pt, text width=#4, align=center},
		column sep=0pt, row sep=0pt, inner sep=0pt,
		#1
	] (#2) {
		\node[font=\normalsize, align=center] {\textbf{#2}}; \\ % nome
		\node[font=\small, align=left] {#3}; \\   % attributi
	};
}



\begin{figure}[h]
	\centering
	
	\begin{tikzpicture}
		\umlsimpleclass[ x = 0, y = 0, fill=white]{Persona}
		\umldomainclass[at={(6, 0)}]{Utente}{username \\ email}{2cm}
		\umldomainclass[at={(6,-2)}]{Amministratore}{rank}{3cm}
		
		\umlsimpleclass[x=10, y=-4, fill=white]{Mappa}
		\umldomainclass[at={(0, -4)}]{Percorso}{stimaTempo \\ distanza \\ stimaCO\textsubscript{2}}{2cm}
		\umldomainclass[at={(6, -4)}]{Posizione}{latitudine \\ longitudine}{2cm}
		
		\umldomainclass[at={(0,-7)}]{ModalitàTrasporto}{velocità \\ CO\textsubscript{2}PerChilometro}{4cm}
		\umlsimpleclass[x=-4.5, y=-9, fill=white]{Cammino}
		\umlsimpleclass[x=-1.5, y=-10, fill=white]{Bici}
		\umlsimpleclass[x=1.5, y=-10, fill=white]{TrasportoPubblico}
		\umlsimpleclass[x=4.5, y=-9, fill=white]{Macchina}		
		
		\umlinherit{Amministratore}{Utente}

		\draw (0,0.35) -- (0,1);
		\draw (6,0.55) -- (6,1);
		\draw (0,1) -- (6,1);
		\node at (3, 1.3) {crea→};
		\node at (-0.2, 0.55) {1};
		\node at (6.35, 0.8) {0..*};
		\node at (3, 0.2) {autenticato\_come→};
		\umlassoc[mult1=1, mult2 = {0,1}]{Persona}{Utente}

		\node at (-1, -2) {cerca↓};
		\umlassoc[mult1=0..*, mult2 = 0..*]{Persona}{Percorso}
		
		\node at (3, -3.85) {passa\_per→};
		\umluniaggreg[mult1=0..*, mult2 = 0..*]{Percorso}{Posizione}

		\node at (8, -3.85) {è\_in→};
		\umlassoc[mult1=0..*, mult2 = 1]{Posizione}{Mappa}
		
		\node at (0.6, -5.5) {usa↓};
		\umlassoc[mult1=0..*, mult2 = 0..*]{Percorso}{ModalitàTrasporto}

		\umlinherit{Cammino}{ModalitàTrasporto}
		\umlinherit{Bici}{ModalitàTrasporto}
		\umlinherit{TrasportoPubblico}{ModalitàTrasporto}
		\umlinherit{Macchina}{ModalitàTrasporto}
	\end{tikzpicture}
\end{figure}